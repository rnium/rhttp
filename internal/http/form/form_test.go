package form

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestForm(t *testing.T) {
	body := "----------------------------727920248995288421927727\r\nContent-Disposition: form-data; name=\"age\"\r\n\r\n544\r\n----------------------------727920248995288421927727\r\nContent-Disposition: form-data; name=\"dp\"; filename=\"rsz_faenza-start-here-debian-symbolicsvg.png\"\r\nContent-Type: image/png\r\n\r\n\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\n\x00\x00\x00\n\b\x04\x00\x00\x00';\a6\x00\x00\x00\x04gAMA\x00\x00\xb1\x8f\v\xfca\x05\x00\x00\x00 cHRM\x00\x00z&\x00\x00\x80\x84\x00\x00\xfa\x00\x00\x00\x80\xe8\x00\x00u0\x00\x00\xea`\x00\x00:\x98\x00\x00\x17p\x9c\xbaQ<\x00\x00\x00\x02bKGD\x00\xff\x87\x8f̿\x00\x00\x00\atIME\a\xea\x01\x03\x10\b%\xcb%\xe9%\x00\x00\x00\xb8IDAT\b\xd7\x05\xc11K\x82a\x18\x85\xe1\xfb<}\xb8\x14\"&\xd4\xe6\xd0\xe0\xd4Oh\x10E\b\xc1I\x14Z\x1d\x82\x86\x86\xe6f砥E\\\x9c\x1c\xfc\t\x82\x9b\x8b\x04\x8d\nN\x8a\x04\xb9E9\xd8{\xba.M\x83\xe4\v\x8d\xa8\xb3\xe6\xc7\x03^P\xe6D\x9e\xb9\u05fa\xf6\x92\xaa&\x94x\x0e\xa1>cj|\xe9V3\xb7is\x92\xb9@\x99\x8er\xdc1\xf3\xa9>X\xe2\xe0\x9c\x8d~)\xfb\xdb\v\xed)\xb2#\x05\a\x04\xac\xa8\xa8\xea+\xdf\xf3f\x82\xad.}c\x18\xd2T\x8bW\xbf\x13\x9aB\xcf\ru\xc9\xf8\xc3\b\x91\x82`\xc0'\x0f\x1c\tg\x16\xc9\nl\xf1ę\x1f\xc9\xeb(\x9b\x9a\xff\x01\xce\x15FG\xb9I\xe0\xc8\x00\x00\x00%tEXtdate:create\x002026-01-03T16:08:06+00:00ͪC\xbd\x00\x00\x00%tEXtdate:modify\x002026-01-03T16:08:06+00:00\xbc\xf7\xfb\x01\x00\x00\x00\x00IEND\xaeB`\x82\r\n----------------------------727920248995288421927727\r\nContent-Disposition: form-data; name=\"name\"\r\n\r\nFoo bar\r\n----------------------------727920248995288421927727--\r\n"
	contentType := "multipart/form-data; boundary=--------------------------727920248995288421927727"
	fdata, err := getFormData(contentType, []byte(body))
	assert.Nil(t, err)
	assert.Equal(t, 2, len(fdata.Fields))
	assert.Equal(t, 1, len(fdata.Files))
}
